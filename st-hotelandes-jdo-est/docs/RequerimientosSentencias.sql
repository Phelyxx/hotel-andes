-- RF7
INSERT INTO A_BOOKING(ID, IDROOM, NUMBEROFADULTS, NUMBEROFCHILDREN, TYPE, BASEPRICE, MINREQUIREDNIGHTS, ACCOMODATIONPRICE, ACCOMMODATIONDISCOUNT, PAYMENTPLAN, TOTALVALUE, PAIDDATE, PAID) 
VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);

INSERT INTO  A_CHECKINOUT (IDBOOKING, DOCUMENTUSER, CHECKINDATE, CHECKINMADE, CHECKOUTDATE, CHECKOUTMADE) 
VALUES (?, ?, ?, ?, ?, ?);

INSERT INTO A_OCCUPANCYDATE (ID, IDROOM, DATESTART, DATEFINISH) 
VALUES (?, ?, ?, ?);

-- RF8
SELECT * FROM A_RESERVATION WHERE IDSERVICE = 1 
AND TO_TIMESTAMP('2022-05-04 09:53:45.0', 'yyyy/mm/dd HH24:MI:SS.FF') BETWEEN "DATE" AND ("DATE" + INTERVAL '60' MINUTE)
OR TO_TIMESTAMP('2022-05-04 09:55:45.0', 'yyyy/mm/dd HH24:MI:SS.FF') BETWEEN "DATE" AND ("DATE" + INTERVAL '60' MINUTE);

INSERT INTO A_RESERVATION(ID, IDSERVICE, DOCUMENTUSER, NUMBEROFGUESTS, "DURATION", "DATE")
VALUES (1, 1, 123, 10, 10, TO_DATE('2022/05/04 10:15', 'yyyy/mm/dd hh24:mi'));

-- RF9

UPDATE A_CHECKINOUT 
SET CHECKINDATE = (TO_TIMESTAMP('2022-04-06 12:45:39.21', 'yyyy-mm-dd HH24:MI:SS.FF')), CHECKINMADE = 1 
WHERE IDBOOKING = 2;

-- RF10
INSERT INTO A_SERVICEINVOICE (ID, IDSERVICE, "VALUE", CREATEDDATE)
VALUES (5, 1, 100, TO_DATE('2022/05/04 10:14', 'yyyy/mm/dd hh24:mi'));

-- RF11
UPDATE A_CHECKINOUT 
SET CHECKOUTDATE = (TO_TIMESTAMP('2022-04-06 12:45:39.21', 'yyyy-mm-dd HH24:MI:SS.FF')), CHECKOUTMADE = 1 
WHERE IDBOOKING = 2;

-- RFC1

SELECT B.IDROOM, A.TOTAL  FROM (
    SELECT IDROOM, SUM(TOTALVALUE) TOTAL FROM A_BOOKING
    WHERE PAIDDATE BETWEEN TO_DATE('2022/05/04 10:14', 'yyyy/mm/dd hh24:mi') AND TO_DATE('2022/05/06 10:15', 'yyyy/mm/dd hh24:mi')
    GROUP BY IDROOM) A, A_BOOKING B
WHERE A.IDROOM = B.IDROOM;

SELECT * FROM (
    SELECT IDROOM, SUM(TOTALVALUE) FROM A_BOOKING
    WHERE PAIDDATE BETWEEN TO_DATE('2022/01/01 00:00', 'yyyy/mm/dd hh24:mi') AND TO_DATE('2022/12/31 00:00', 'yyyy/mm/dd hh24:mi')
    GROUP BY IDROOM) A, A_BOOKING B
WHERE A.IDROOM = B.IDROOM;

-- RFC2    
SELECT IDSERVICE, CONSUMO FROM(
    SELECT IDSERVICE, CREATEDDATE, COUNT(*) CONSUMO
    FROM A_SERVICEINVOICE
    WHERE CREATEDDATE BETWEEN TO_DATE('2022/05/04 10:14', 'yyyy/mm/dd hh24:mi') AND TO_DATE('2022/05/04 10:15', 'yyyy/mm/dd hh24:mi')
    GROUP BY IDSERVICE, CREATEDDATE)
WHERE ROWNUM <=20;

-- RFC3
SELECT IDROOM, ROUND(((total*100)/dias),2) AS OCUPACION FROM (
    SELECT IDROOM, COUNT(*) AS total, ROUND((TO_DATE('2022/07/04 10:15', 'yyyy/mm/dd hh24:mi')) - (TO_DATE('2022/05/04 10:14', 'yyyy/mm/dd hh24:mi'))) DIAS
        FROM (SELECT * FROM A_BOOKING
        WHERE PAIDDATE BETWEEN TO_DATE('2022/05/04 10:14', 'yyyy/mm/dd hh24:mi') AND TO_DATE('2022/07/04 10:15', 'yyyy/mm/dd hh24:mi')), DUAL
    GROUP BY IDROOM);

-- RFC4

SELECT * FROM A_SERVICE
WHERE EMPLOYEETHATREGISTER = '384923492';

SELECT * FROM A_SERVICE
WHERE "TYPE" = 'SPA';

SELECT * FROM A_SERVICE
WHERE "CATEGORY" = 'RESERVABLE';

-- RFC5

SELECT DOCUMENT, SUM("VALUE") 
FROM ( SELECT B.DOCUMENT, D.VALUE FROM A_CONSUMEDSERVICES A, A_USER B, A_CHECKINOUT C, A_SERVICEINVOICE D
        WHERE A.IDBOOKING = C.IDBOOKING AND B.DOCUMENT = 812941840 AND A.IDSERVICEINVOICE = D.ID 
        AND D.PAIDDATE BETWEEN TO_TIMESTAMP('2021-04-03 12:45:39.21', 'yyyy-mm-dd HH24:MI:SS.FF') AND
        TO_TIMESTAMP('2022-12-06 12:55:32.585', 'yyyy/mm/dd HH24:MI:SS.FF'))
GROUP BY DOCUMENT